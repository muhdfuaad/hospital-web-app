{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/HOSPITALAPP/hospitalapp/src/app/appform/location/Panchayaths/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\n\r\ninterface District {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface Panchayath {\r\n  panchayathId: number;\r\n  panchayathName: string;\r\n  dstName : string;\r\n  dstId: number; // Be sure your backend sends this exact casing; adjust if needed\r\n}\r\n\r\nexport default function PanchayathsPage() {\r\n  const [districts, setDistricts] = useState<District[]>([]);\r\n  const [panchayaths, setPanchayaths] = useState<Panchayath[]>([]);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [panchayathName, setPanchayathName] = useState('');\r\n  const [selectedDistrictId, setSelectedDistrictId] = useState<number | ''>('');\r\n  const [editingId, setEditingId] = useState<number | null>(null);\r\n\r\n  // Fetch districts and panchayaths\r\n  const fetchData = async () => {\r\n    try {\r\n      const districtRes = await fetch('https://localhost:7112/api/Districts');\r\n      if (!districtRes.ok) throw new Error('Failed to fetch districts');\r\n      const districtData = await districtRes.json();\r\n      setDistricts(districtData);\r\n\r\n      const panchayathRes = await fetch('https://localhost:7112/api/Panchayaths');\r\n      if (!panchayathRes.ok) throw new Error('Failed to fetch panchayaths');\r\n      const panchayathData = await panchayathRes.json();\r\n      setPanchayaths(panchayathData);\r\n      console.log(panchayathData);\r\n    } catch (err) {\r\n      console.error('Failed fetching data:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const handleSave = async () => {\r\n    if (!panchayathName.trim()) {\r\n      alert('Enter panchayath name');\r\n      return;\r\n    }\r\n    if (!selectedDistrictId) {\r\n      alert('Select a district');\r\n      return;\r\n    }\r\n\r\n    const method = editingId ? 'PUT' : 'POST';\r\n    const url = editingId\r\n      ? `https://localhost:7112/api/Panchayaths/${editingId}`\r\n      : 'https://localhost:7112/api/Panchayaths';\r\n\r\n    // Adjust property names if API expects PascalCase — check your API contract!\r\n    const bodyData = {\r\n      id: editingId || 0,\r\n      name: panchayathName.trim(),\r\n      dstId: selectedDistrictId,\r\n      status: 1, // if your API requires status\r\n    };\r\n\r\n    try {\r\n      const res = await fetch(url, {\r\n        method,\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(bodyData),\r\n      });\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(`Failed saving panchayath: ${errorText}`);\r\n      }\r\n      // Clear form and refresh data only after successful save\r\n      setPanchayathName('');\r\n      setSelectedDistrictId('');\r\n      setEditingId(null);\r\n      setShowModal(false);\r\n      await fetchData();\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Failed saving panchayath, see console.');\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id: number) => {\r\n    if (!confirm('Are you sure to delete this panchayath?')) return;\r\n    try {\r\n      const res = await fetch(`https://localhost:7112/api/Panchayaths/${id}`, { method: 'DELETE' });\r\n      if (!res.ok) {\r\n        const errorText = await res.text();\r\n        throw new Error(`Failed deleting panchayath: ${errorText}`);\r\n      }\r\n      await fetchData();\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('Failed deleting panchayath, see console.');\r\n    }\r\n  };\r\n\r\n  const getDistrictName = (id: number) => {\r\n    const district = districts.find((d) => d.id === id);\r\n    return district ? district.name : '-';\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6\">\r\n      <nav className=\"flex gap-4 mb-4\">\r\n        <Link href=\"/appform/location/Districts\" className=\"text-blue-600 hover:underline\">\r\n          Districts\r\n        </Link>\r\n        <Link href=\"/appform/location/Panchayaths\" className=\"text-blue-600 hover:underline\">\r\n          Panchayaths\r\n        </Link>\r\n        <Link href=\"/appform\" className=\"text-blue-600 hover:underline\">\r\n          Reg Form\r\n        </Link>\r\n        <Link href=\"/appform/location\" className=\"text-blue-600 hover:underline\">\r\n          Location tables\r\n        </Link>\r\n      </nav>\r\n\r\n      <h2 className=\"text-xl font-bold mb-4\">Panchayaths</h2>\r\n      <button\r\n        onClick={() => {\r\n          setShowModal(true);\r\n          setEditingId(null);\r\n          setPanchayathName('');\r\n          setSelectedDistrictId('');\r\n        }}\r\n        className=\"bg-blue-600 text-white px-4 py-2 rounded mb-4\"\r\n      >\r\n        ➕ Add Panchayath\r\n      </button>\r\n\r\n      <table className=\"w-full border border-collapse border-gray-300\">\r\n        <thead className=\"bg-gray-200\">\r\n          <tr>\r\n            <th className=\"px-4 py-2 text-left border border-gray-300\">ID</th>\r\n            <th className=\"px-4 py-2 text-left border border-gray-300\">Name</th>\r\n            <th className=\"px-4 py-2 text-left border border-gray-300\">District</th>\r\n            <th className=\"px-4 py-2 text-left border border-gray-300\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {panchayaths.length > 0 ? (\r\n            panchayaths.map((p) => (\r\n              <tr key={p.panchayathId} className=\"border-t border-gray-300\">\r\n                <td className=\"px-4 py-2 text-left border border-gray-300\">{p.panchayathId}</td>\r\n                <td className=\"px-4 py-2 text-left border border-gray-300\">{p.panchayathName}</td>\r\n                <td className=\"px-4 py-2 text-left border border-gray-300\">{p.dstName}</td>\r\n                <td className=\"px-4 py-2 text-left border border-gray-300\">\r\n                  <div className=\"flex gap-2\">\r\n                    <button\r\n                      onClick={() => {\r\n                        setEditingId(p.panchayathId);\r\n                        setPanchayathName(p.panchayathName);\r\n                        setSelectedDistrictId(p.dstId);\r\n                        setShowModal(true);\r\n                      }}\r\n                      className=\"bg-yellow-400 px-2 py-1 rounded\"\r\n                    >\r\n                      Edit\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleDelete(p.panchayathId)}\r\n                      className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n                    >\r\n                      Delete\r\n                    </button>\r\n                  </div>\r\n                </td>\r\n              </tr>\r\n            ))\r\n          ) : (\r\n            <tr>\r\n              <td colSpan={4} className=\"px-4 py-2 text-center text-gray-500\">\r\n                No panchayaths found\r\n              </td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n\r\n      {showModal && (\r\n        <div className=\"fixed inset-0 bg-black/30 flex justify-center items-center z-50\">\r\n          <div className=\"bg-white p-6 rounded-lg w-full max-w-sm shadow-lg\">\r\n            <h3 className=\"text-lg font-semibold mb-4\">{editingId ? '✏️ Edit' : '➕ Add'} Panchayath</h3>\r\n            <input\r\n              value={panchayathName}\r\n              onChange={(e) => setPanchayathName(e.target.value)}\r\n              className=\"w-full border px-3 py-2 mb-4 rounded\"\r\n              placeholder=\"Panchayath Name\"\r\n            />\r\n            <select\r\n              value={selectedDistrictId}\r\n              onChange={(e) => setSelectedDistrictId(Number(e.target.value))}\r\n              className=\"w-full border px-3 py-2 mb-4 rounded\"\r\n            >\r\n              <option value=\"\" disabled>\r\n                Select District\r\n              </option>\r\n              {districts.map((d) => (\r\n                <option key={d.id} value={d.id}>\r\n                  {d.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n            <div className=\"flex justify-end gap-2\">\r\n              <button onClick={() => setShowModal(false)} className=\"border px-4 py-2 rounded\">\r\n                Cancel\r\n              </button>\r\n              <button onClick={handleSave} className=\"bg-blue-600 text-white px-4 py-2 rounded\">\r\n                Save\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}